import{$ as m,$$ as f,on as r,dispatch as i,attr as d,next as h,prev as _,hotkey as E,behavior as u,makelogger as g}from"./19.js";const s=g("menu"),k="[role=menu]",n="[role=menuitem]",p=e=>m(e,n),v=e=>f(e,n).at(-1),l=e=>!e.hidden,w=u(k,(e,{root:a})=>{if(!(e instanceof HTMLElement))return;let o;f(e,n).forEach(t=>t.setAttribute("tabindex","-1")),r(e,"menu:open",t=>{o=t.detail.opener,e.hidden=!1,s("menu:open",e.hidden),p(e).focus(),s("menu:open 2",e.hidden)}),r(e,"menu:close",t=>{s("menu:close",e.hidden=!0),o?.focus()}),r(e,"focusout",t=>{!l(e)||e.contains(t.relatedTarget)||o!==t.relatedTarget&&i(e,"menu:close")}),r(e,"keydown",t=>{t.preventDefault(),E({ArrowUp:c=>_(e,n,a.activeElement).focus(),ArrowDown:c=>h(e,n,a.activeElement).focus(),Space:c=>a.activeElement?.closest(n)?.click(),Home:c=>p(e).focus(),End:c=>v(e).focus(),Escape:c=>i(e,"menu:close")})(t)}),r(window,"click",t=>{!l(e)||o!==t.target&&i(e,"menu:close")},{addedBy:e})}),y=u("[aria-haspopup=menu]",(e,{root:a})=>{const o=a.getElementById(d(e,"aria-controls"));r(o,"menu:close",t=>d(e,"aria-expanded","false"),{addedBy:e}),r(o,"menu:open",t=>d(e,"aria-expanded","true"),{addedBy:e}),r(e,"click",()=>i(o,l(o)?"menu:close":"menu:open",{opener:e}))});w(document);y(document);export{w as menu,y as menuButton};
